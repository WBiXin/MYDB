# Q&A
## 每个模块的职责（介绍项目）
- TM(Transaction Manager):通过维护XID文件来维护事务的状态，并提供接口供其他模块来查询某个事务的状态；支持事务状态的实时查询，增强了事务控制的灵活性
- DM(Data Manager):直接管理数据库DB文件和日志文件。DM的主要职责：\
  1.分页管理DB文件，并进行缓存；\
  2.管理日志文件，保证在发生错误的时候可以根据日志进行恢复；\
  3.抽象DB文件为DataItem供上层模块使用，并提供缓存
- VM(Version Manager):基于两段锁协议实现了调度序列的可串行化，并实现了MVCC以消除读写阻塞。同时实现了两种隔离级别（读提交和可重复读）
- IM(Index Manager):实现了基于B+树的聚簇索引，***BTW????***,目前where只支持已索引字段
- TBM(Table Manager):实现了对字段和表的管理。同时解析SQL语句，并根据语句操作表


## 技术亮点
- *日志管理：引入数据库日志管理机制，通过日志保障数据一致性，实现故障恢复功能，强化了数据的安全性和稳定性*
- *NIO 文件操作：采用 Java NIO 技术优化数据库文件的读写操作，提高数据访问效率*
- *MVCC 与锁协议：基于两阶段锁（2PL）协议和 MVCC 实现事务的可串行化，优化了读写并发处理，减少阻塞，支持不同隔离级别的实现；\
  死锁处理*
- *索引与表管理：实现基于 B+ 树的聚簇索引，支持高效的索引查找；并构建表管理器，负责管理表结构和字段信息，包括 SQL 语句的解析功能*
- *网络通信：通过 Socket 编程实现数据库与客户端的通信，支持执行类 SQL 语句并返回查询结果；客户端提供简易 Shell 界面，方便用户操作*

## *执行过程示例*
*以 **insert into student values "张三" 123456** 为例：*
- *1、TBM接受语句，并进行解析*
- *2、TBM将values的值二进制化*
- *3、TBM利用VM的insert操作, 将二进制化后的数据, 插入到数据库文件*
- *4、VM为该条数据建立版本控制, 并利用DM的insert操作, 将数据插入到数据库*
- *5、DM将数据插入到数据库, 并返回其被存储的地址*
- *6、VM将得到的地址, 作为该条记录的handler, 返回给TBM*
- *7、TBM计算该条语句的key, 并将handler作为data, 并调用IM的insert, 建立索引*
- *8、IM利用DM提供的read和insert等操作, 将key和data存入索引中*
- *9、TBM返回客户端插入成功的信息*
